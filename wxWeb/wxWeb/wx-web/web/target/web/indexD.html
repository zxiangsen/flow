<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>HTML..</title>

<!--封装好的视频布局样式-->
<link rel="stylesheet" href="css/jsmodern.min.css">
<script src="js/jquery.min.js"></script>
<!--mp4视频插件-->
<script src="js/jsmodern.min.js"></script>
<script type="text/javascript" src="./js/jquery-1.8.0.min.js"></script>

<style>
#video {
	width: 970px;
	height: 594px;
	margin: 0 auto;
	position: relative;
	margin-top: 20px;
}

#video video {
	width: 100%;
	height: 100%;
	object-fit: fill;
}

.VideoBtn {
	position: absolute;
	left: 50%;
	top: 50%;
	display: block;
	width: 70px;
	height: 70px;
	margin-left: -35px;
	margin-top: -35px;
	cursor: pointer;
	z-index: 10;
}
</style>

<!--视频插件调用方法-->

</head>
<body>

<div id="video">
	<video poster="shipinimg/ckin.jpg"
			src="https://blz-videos.nosdn.127.net/1/OverWatch/AnimatedShots/Overwatch_AnimatedShot_Soldier76_Hero.mp4"
		   id="videoShow">
	</video>
	<!--<span class="VideoBtn"><img src="images/bo1.png"></span>-->
</div>
<script src="https://res2.wx.qq.com/open/js/jweixin-1.4.0.js"></script>
<script type="text/javascript" language=JavaScript charset="UTF-8">
	var ZXSurl = "";

	$(function(){
		var url =window.location.href.split('#')[0];
		ZXSurl = url;
		var location = window.location;
		var location = (window.location+'').split('/');
		var basePath = location[0]+'//'+location[2]+'/'+location[3]+'/';
		console.log("basePath:"+basePath);

		$.ajax({
			url: basePath+"webemployee/signature.action",
			data: {url:url},
			async:false,
			success: function(data){
				console.log(data);
				wx.config({
					debug: false, // 开启调试模式,调用的所有api的返回值会在客户端alert出来，若要查看传入的参数，可以在pc端打开，参数信息会通过log打出，仅在pc端时才会打印。
					appId: data.appId, // 必填，公众号的唯一标识
					timestamp: data.timestamp, // 必填，生成签名的时间戳
					nonceStr: data.nonceStr, // 必填，生成签名的随机串
					signature: data.signature,// 必填，签名，见附录1
					jsApiList: ["checkJsApi", "updateAppMessageShareData", "updateTimelineShareData","onMenuShareAppMessage","onMenuShareTimeline"] // 必填，需要使用的JS接口列表，所有JS接口列表见附录2
				});
			}

		});
	});
	wx.ready(function () {
		//自定义“分享给朋友”及“分享到QQ”按钮的分享内容（1.4.0）
		wx.updateAppMessageShareData({
			title: '九零一族', // 分享标题
			desc: '测试1', // 分享描述
			link: ZXSurl, // 分享链接
			imgUrl: 'https://zxs2018.oss-cn-beijing.aliyuncs.com/Novel/dushi.jpg',
			success: function (res) {
				//alert('已分享');
			},
			cancel: function (res) {
				//alert('已取消');
			},
			fail: function (res) {
				//alert(JSON.stringify(res));
			}
		});
		//自定义“分享给朋友” 旧接口
		wx.onMenuShareAppMessage({
			title: '九零一族', // 分享标题
			desc: '测试Z', // 分享描述
			link: ZXSurl, // 分享链接
			imgUrl: 'https://zxs2018.oss-cn-beijing.aliyuncs.com/Novel/dushi.jpg',
			success: function (res) {
				//alert('已分享X');
			},
			cancel: function (res) {
				//alert('已取消');
			}
		});

		//自定义“分享到朋友圈”及“分享到QQ空间”按钮的分享内容（1.4.0）
		wx.updateTimelineShareData({
			title: '九零一族', // 分享标题
			link: ZXSurl, // 分享链接
			imgUrl: 'https://zxs2018.oss-cn-beijing.aliyuncs.com/Novel/dushi.jpg', // 分享图标
			type: '', // 分享类型,music、video或link，不填默认为link
			dataUrl: '', // 如果type是music或video，则要提供数据链接，默认为空
			success: function () {
				// 用户确认分享后执行的回调函数
				//alert("分享");
			},
			cancel: function () {
				// 用户取消分享后执行的回调函数
				//alert("取消分享");
			}
		});
		//自定义“分享到朋友圈” 旧接口
		wx.onMenuShareTimeline({
			title: '九零一族Z', // 分享标题
			link: ZXSurl, // 分享链接
			imgUrl: 'https://zxs2018.oss-cn-beijing.aliyuncs.com/Novel/dushi.jpg', // 分享图标
			type: '', // 分享类型,music、video或link，不填默认为link
			dataUrl: '', // 如果type是music或video，则要提供数据链接，默认为空
			success: function () {
				// 用户确认分享后执行的回调函数
				//alert("分享");
			},
			cancel: function () {
				// 用户取消分享后执行的回调函数
				//alert("取消分享");
			}
		});
	});

	//视频
	jsModern.video("#video");
	//播放视频
	$(".VideoBtn").click(function () {
			var video = document.getElementById("videoShow");
			video.play();
			$('.VideoBtn').hide();
	})
		//监听视频的播放状态
	var video = document.getElementById("videoShow");
	video.oncanplay = function () {
		$(".VideoBtn").show();
		//$("#video").attr("poster","");
	}
		//视频播放事件
	video.onplay = function () {
		console.log(4);
			$("#videoShow").attr("poster", "");
			$(".VideoBtn").hide();
	};
	video.onplaying = function () {
		console.log(5);
			$(".VideoBtn").hide();
	};

	//视频暂停事件
	video.onpause = function () {
		console.log(1);
			$(".VideoBtn").show();
	};
	//点击视频周围暂停播放图片出现
	video.onclick = function () {
		console.log(2);
			if (video.paused) {
				$(".VideoBtn").hide();
				video.play();
			} else {
				$(".VideoBtn").show();
				video.pause();
			}
	};

	video.addEventListener("timeupdate",function(){
		console.log(3);
		var timeDisplay;
		//用秒数来显示当前播放进度
		timeDisplay = Math.floor(video.currentTime);
		console.log(Math.floor(video.currentTime))
		//当视频播放到 4s的时候做处理
		if(timeDisplay > 20){
			//处理代码
			$(".VideoBtn").show();
			video.pause();
		}
	},false);


</script>
</body>
</html>

